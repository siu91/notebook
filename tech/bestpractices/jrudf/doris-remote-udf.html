<!DOCTYPE HTML>
<html lang="zh-CN" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Doris Remote UDF çš„å¼€å‘å’Œæµ‹è¯• - Siu çš„ç¬”è®°æœ¬</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        
        <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../../../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../highlight.css">
        <link rel="stylesheet" href="../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
        <link rel="stylesheet" href="../../../theme/style.css">
        

        

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');
                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }
                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../../SUMMARY.html"><strong aria-hidden="true">1.</strong> æ€è€ƒå’Œæ€»ç»“ğŸ¤”</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../mgmt/srcwd/index.html"><strong aria-hidden="true">1.1.</strong> å›¢é˜Ÿäººå‘˜æ¨¡å‹</a></li><li class="chapter-item "><a href="../../../tech/backend/java-mem-mgmt/java-memory-management.html"><strong aria-hidden="true">1.2.</strong> è°ˆè°ˆ Java çš„å†…å­˜ç®¡ç†</a></li></ol></li><li class="chapter-item expanded "><a href="../../../SUMMARY.html"><strong aria-hidden="true">2.</strong> æ¶æ„å’Œè®¾è®¡</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../tech/backend/Java-Backend-Framework-Selection-Guide.html"><strong aria-hidden="true">2.1.</strong> Java åç«¯æ¡†æ¶é€‰å‹æŒ‡å—</a></li><li class="chapter-item "><a href="../../../tech/project/PGHA/pg-ha-solution.html"><strong aria-hidden="true">2.2.</strong> PG HA æ–¹æ¡ˆ</a></li><li class="chapter-item "><a href="../../../tech/project/kubesphere/åŸºäºLinuxå®‰è£…kubesphere3å¤šèŠ‚ç‚¹é›†ç¾¤(prod).html"><strong aria-hidden="true">2.3.</strong> KuberSphere ç”Ÿäº§éƒ¨ç½²æ–¹æ¡ˆ</a></li><li class="chapter-item "><a href="../../../tech/project/lwpoc/lwpoc/æ¶æ„/æ„å»ºå®æ—¶æ¹–ä»“.html"><strong aria-hidden="true">2.4.</strong> æ„å»ºå®æ—¶æ¹–ä»“</a></li><li class="chapter-item "><a href="../../../tech/project/cicd/index.html"><strong aria-hidden="true">2.5.</strong> CICD è®¾è®¡</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../tech/project/cicd/design/CICDæ¶æ„.html"><strong aria-hidden="true">2.5.1.</strong> CI/CD æ¶æ„</a></li><li class="chapter-item "><a href="../../../tech/project/cicd/design/Jenkins_Cluster.html"><strong aria-hidden="true">2.5.2.</strong> Jenkins é›†ç¾¤</a></li><li class="chapter-item "><a href="../../../tech/project/cicd/design/å¤šåˆ†æ”¯æµæ°´çº¿è®¾è®¡.html"><strong aria-hidden="true">2.5.3.</strong> å¤šåˆ†æ”¯æµæ°´çº¿è®¾è®¡</a></li><li class="chapter-item "><a href="../../../tech/project/cicd/design/cec-jplè®¾è®¡.html"><strong aria-hidden="true">2.5.4.</strong> cec-jpl è®¾è®¡</a></li><li class="chapter-item "><a href="../../../tech/project/cicd/design/æ•°æ®åº“è‡ªåŠ¨åŒ–.html"><strong aria-hidden="true">2.5.5.</strong> æ•°æ®åº“è‡ªåŠ¨åŒ–</a></li><li class="chapter-item "><a href="../../../tech/project/cicd/design/è´¦å·ä½“ç³».html"><strong aria-hidden="true">2.5.6.</strong> è´¦å·ä½“ç³»</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../SUMMARY.html"><strong aria-hidden="true">3.</strong> æœ€ä½³å®è·µ</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../tech/bestpractices/How-to-write-an-outline-for-a-technical-solution/index.html"><strong aria-hidden="true">3.1.</strong> æ€æ ·å†™ä¸€ä¸ªæŠ€æœ¯æ–¹æ¡ˆçš„å¤§çº²</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../tech/bestpractices/How-to-write-an-outline-for-a-technical-solution/template.html"><strong aria-hidden="true">3.1.1.</strong> ã€ŠæŠ€æœ¯è§£å†³æ–¹æ¡ˆã€‹æ¨¡ç‰ˆ</a></li></ol></li><li class="chapter-item "><a href="../../../tech/bestpractices/my-toolchain.html"><strong aria-hidden="true">3.2.</strong> åˆ†äº«ä¸€ä¸‹æˆ‘çš„å·¥å…·æ¸…å•</a></li><li class="chapter-item "><a href="../../../tech/bestpractices/sqlæ€§èƒ½æµ‹è¯•å·¥å…·çš„è®¾è®¡.html"><strong aria-hidden="true">3.3.</strong> sql æ€§èƒ½æµ‹è¯•å·¥å…·çš„è®¾è®¡</a></li><li class="chapter-item expanded "><a href="../../../tech/bestpractices/jrudf/doris-remote-udf.html" class="active"><strong aria-hidden="true">3.4.</strong> Doris Remote UDF çš„å¼€å‘å’Œæµ‹è¯•</a></li><li class="chapter-item "><a href="../../../tech/bestpractices/ç¦…é“å·¥ä½œæµ.html"><strong aria-hidden="true">3.5.</strong> ç¦…é“å·¥ä½œæµ</a></li><li class="chapter-item "><a href="../../../tech/bestpractices/å•å…ƒæµ‹è¯•è§„èŒƒ.html"><strong aria-hidden="true">3.6.</strong> å•å…ƒæµ‹è¯•è§„èŒƒ</a></li><li class="chapter-item "><a href="../../../tech/bestpractices/æ•°æ®åº“è‡ªåŠ¨åŒ–-Flywayä½¿ç”¨è§„èŒƒ.html"><strong aria-hidden="true">3.7.</strong> æ•°æ®åº“è‡ªåŠ¨åŒ–ï¼šFlyway</a></li><li class="chapter-item "><a href="../../../tech/bestpractices/è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶è§„èŒƒ.html"><strong aria-hidden="true">3.8.</strong> è¯­ä¹‰åŒ–ç‰ˆæœ¬</a></li><li class="chapter-item "><a href="../../../tech/bestpractices/APIè®¾è®¡è§„èŒƒ.html"><strong aria-hidden="true">3.9.</strong> APIè®¾è®¡è§„èŒƒ</a></li><li class="chapter-item "><a href="../../../tech/bestpractices/git-collaborative-development-tutorials/gitååŒå¼€å‘æŒ‡å—.html"><strong aria-hidden="true">3.10.</strong> git ååŒå¼€å‘æŒ‡å—</a></li><li class="chapter-item "><a href="../../../tech/bestpractices/code-review-guide-baseon-gitlab.html"><strong aria-hidden="true">3.11.</strong> Gitlab Code Review æŒ‡å—</a></li><li class="chapter-item "><a href="../../../tech/bestpractices/gitlab-issue-workflow.html"><strong aria-hidden="true">3.12.</strong> Gitlab Issue å·¥ä½œæµ</a></li><li class="chapter-item "><a href="../../../tech/bestpractices/Pythonç¼–ç è§„èŒƒ.html"><strong aria-hidden="true">3.13.</strong> Python ç¼–ç è§„èŒƒ</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Siu çš„ç¬”è®°æœ¬</h1>

                    <div class="right-buttons">
                        
                        
                        <a href="https://github.com/siu91/notebook" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                        

                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <!-- Page table of contents -->
                    <div class="sidetoc"><nav class="pagetoc"></nav></div>
                    <main>
                        <h1><a class="header" href="#doris--remote-udf-çš„å¼€å‘å’Œæµ‹è¯•" id="doris--remote-udf-çš„å¼€å‘å’Œæµ‹è¯•">Doris  Remote UDF çš„å¼€å‘å’Œæµ‹è¯•</a></h1>
<blockquote>
<p>By <a href="">Siu</a> 2021/3/15</p>
</blockquote>
<h2><a class="header" href="#remote-udf-ä»‹ç»" id="remote-udf-ä»‹ç»">Remote UDF ä»‹ç»</a></h2>
<blockquote>
<p>ä»¥ä¸‹å‚è€ƒå®˜æ–¹çš„æ–‡æ¡£ï¼š</p>
<p>Remote UDF Service æ”¯æŒé€šè¿‡ RPC çš„æ–¹å¼è®¿é—®ç”¨æˆ·æä¾›çš„ UDF Serviceï¼Œä»¥å®ç°ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°çš„æ‰§è¡Œã€‚ç›¸æ¯”äº Native çš„ UDF å®ç°ï¼ŒRemote UDF Service æœ‰å¦‚ä¸‹ä¼˜åŠ¿å’Œé™åˆ¶ï¼š</p>
<p>ä¼˜åŠ¿</p>
<ul>
<li>è·¨è¯­è¨€ï¼šå¯ä»¥ç”¨ Protobuf æ”¯æŒçš„å„ç±»è¯­è¨€ç¼–å†™ UDF Serviceã€‚</li>
<li>å®‰å…¨ï¼šUDF æ‰§è¡Œå¤±è´¥æˆ–å´©æºƒï¼Œä»…ä¼šå½±å“ UDF Service è‡ªèº«ï¼Œè€Œä¸ä¼šå¯¼è‡´ Doris è¿›ç¨‹å´©æºƒã€‚</li>
<li>çµæ´»ï¼šUDF Service ä¸­å¯ä»¥è°ƒç”¨ä»»æ„å…¶ä»–æœåŠ¡æˆ–ç¨‹åºåº“ç±»ï¼Œä»¥æ»¡è¶³æ›´å¤šæ ·çš„ä¸šåŠ¡éœ€æ±‚ã€‚</li>
</ul>
<p>ä½¿ç”¨é™åˆ¶</p>
<ul>
<li>æ€§èƒ½ï¼šç›¸æ¯”äº Native UDFï¼ŒUDF Service ä¼šå¸¦æ¥é¢å¤–çš„ç½‘ç»œå¼€é”€ï¼Œå› æ­¤æ€§èƒ½ä¼šè¿œä½äº Native UDFã€‚åŒæ—¶ï¼ŒUDF Service è‡ªèº«çš„å®ç°ä¹Ÿä¼šå½±å“å‡½æ•°çš„æ‰§è¡Œæ•ˆç‡ï¼Œç”¨æˆ·éœ€è¦è‡ªè¡Œå¤„ç†é«˜å¹¶å‘ã€çº¿ç¨‹å®‰å…¨ç­‰é—®é¢˜ã€‚</li>
<li>å•è¡Œæ¨¡å¼å’Œæ‰¹å¤„ç†æ¨¡å¼ï¼šDoris åŸå…ˆçš„çš„åŸºäºè¡Œå­˜çš„æŸ¥è¯¢æ‰§è¡Œæ¡†æ¶ä¼šå¯¹æ¯ä¸€è¡Œæ•°æ®æ‰§è¡Œä¸€æ¬¡ UDF RPC è°ƒç”¨ï¼Œå› æ­¤æ‰§è¡Œæ•ˆç‡éå¸¸å·®ï¼Œè€Œåœ¨æ–°çš„å‘é‡åŒ–æ‰§è¡Œæ¡†æ¶ä¸‹ï¼Œä¼šå¯¹æ¯ä¸€æ‰¹æ•°æ®ï¼ˆé»˜è®¤2048è¡Œï¼‰æ‰§è¡Œä¸€æ¬¡ UDF RPC è°ƒç”¨ï¼Œå› æ­¤æ€§èƒ½æœ‰æ˜æ˜¾æå‡ã€‚å®é™…æµ‹è¯•ä¸­ï¼ŒåŸºäºå‘é‡åŒ–å’Œæ‰¹å¤„ç†æ–¹å¼çš„ Remote UDF æ€§èƒ½å’ŒåŸºäºè¡Œå­˜çš„ Native UDF æ€§èƒ½ç›¸å½“ï¼Œå¯ä¾›å‚è€ƒ</li>
</ul>
</blockquote>
<p><strong>æ‰€ä»¥ï¼Œ Doris Remote UDF å¼€å‘ï¼Œå…¶å®å°±æ˜¯å¼€å‘ä¸€ä¸ª RPC æœåŠ¡ï¼Œä»¥ RPC è®¿é—®çš„æ–¹å¼æä¾› UDF æœåŠ¡ã€‚</strong></p>
<h2><a class="header" href="#remote-udf-å¼€å‘" id="remote-udf-å¼€å‘">Remote UDF å¼€å‘</a></h2>
<blockquote>
<p>ä¸»è¦æ˜¯ RPC Server éƒ¨åˆ†çš„å¼€å‘ã€‚</p>
</blockquote>
<h3><a class="header" href="#è®¾è®¡" id="è®¾è®¡">è®¾è®¡</a></h3>
<p><img src="assets/arch.svg" alt="" /></p>
<h3><a class="header" href="#å¼€å‘coding" id="å¼€å‘coding">å¼€å‘ï¼ˆcodingï¼‰</a></h3>
<h4><a class="header" href="#ç¼–è¯‘-proto" id="ç¼–è¯‘-proto">ç¼–è¯‘ proto</a></h4>
<p><em><strong>éœ€è¦å®‰è£… protoc ç¯å¢ƒ</strong></em></p>
<p>ä»å®˜æ–¹ proto fileè¿›è¡Œç¼–è¯‘ï¼Œå½“å‰å·²ç»ç¼–è¯‘æ”¾åœ¨ <code>libs/doris-rudf-grpclib.jar</code></p>
<h4><a class="header" href="#ä»£ç ç»“æ„" id="ä»£ç ç»“æ„">ä»£ç ç»“æ„</a></h4>
<pre><code class="language-shell">.
â”œâ”€â”€ libs
â”‚Â Â  â””â”€â”€ doris-rudf-grpclib.jar # proto ç¼–è¯‘çš„åŒ…ï¼Œä½œä¸º local lib
â”œâ”€â”€ proto # åŸå§‹ proto æ–‡ä»¶
â”‚Â Â  â”œâ”€â”€ function_service.proto
â”‚Â Â  â””â”€â”€ types.proto
â”œâ”€â”€ src
â”‚Â Â  â””â”€â”€ main
â”‚Â Â      â”œâ”€â”€ java
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ com
â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ siu
â”‚Â Â      â”‚Â Â  â”‚Â Â      â””â”€â”€ udf
â”‚Â Â      â”‚Â Â  â”‚Â Â          â””â”€â”€ SubFunction.java # å®ç° IFunctionï¼Œä¼šä»¥ SPI çš„æ–¹å¼æ³¨å†Œåˆ° Functions 
â”‚Â Â      â”‚Â Â  â””â”€â”€ org
â”‚Â Â      â”‚Â Â      â””â”€â”€ apache
â”‚Â Â      â”‚Â Â          â””â”€â”€ doris
â”‚Â Â      â”‚Â Â              â””â”€â”€ udf
â”‚Â Â      â”‚Â Â                  â”œâ”€â”€ Main.java # å…¥å£
â”‚Â Â      â”‚Â Â                  â”œâ”€â”€ func
â”‚Â Â      â”‚Â Â                  â”‚Â Â  â”œâ”€â”€ Functions.java # å•ä¾‹ï¼Œä»¥SPI æ–¹å¼åŠ è½½ UDF
â”‚Â Â      â”‚Â Â                  â”‚Â Â  â””â”€â”€ IFunction.java # å‡½æ•°æ¥å£å®šä¹‰ï¼Œéœ€è¦å®ç° call(),check(),getName()
â”‚Â Â      â”‚Â Â                  â””â”€â”€ server
â”‚Â Â      â”‚Â Â                      â”œâ”€â”€ FunctionServiceImpl.java # Doris Remote UDF å®šä¹‰çš„æ¥å£ï¼Œè¿™é‡Œéœ€è¦å®ç° checkFn(), callFn(),handShake()
â”‚Â Â      â”‚Â Â                      â””â”€â”€ RpcServer.java
â”‚Â Â      â””â”€â”€ resources
â”‚Â Â          â””â”€â”€ META-INF
â”‚Â Â              â””â”€â”€ services
â”‚Â Â                  â””â”€â”€ org.apache.doris.udf.func.IFunction # SPI å®šä¹‰æ–‡ä»¶
â””â”€â”€ target # target code
</code></pre>
<h4><a class="header" href="#ç¼–è¯‘å’Œè¿è¡Œ" id="ç¼–è¯‘å’Œè¿è¡Œ">ç¼–è¯‘å’Œè¿è¡Œ</a></h4>
<pre><code class="language-shell"># ç¼–è¯‘
mvn package
</code></pre>
<pre><code class="language-shell"># è¿è¡Œ
java -jar jrudf-jar-with-dependencies.jar 9000
</code></pre>
<p><code>9000</code> æ˜¯é»˜è®¤ç«¯å£ï¼Œå¯ä»¥ä¸ä¼ </p>
<h3><a class="header" href="#è°ƒè¯•debug" id="è°ƒè¯•debug">è°ƒè¯•ï¼ˆdebugï¼‰</a></h3>
<blockquote>
<p>æ¨èè¿œç¨‹è°ƒè¯•ï¼Œåœ¨ Remote UDF åœºæ™¯ä¸­è¿œç¨‹è°ƒè¯•æ˜¯æœ€æœ‰æ•ˆçš„ï¼Œå› ä¸ºæ•´ä½“ä¸Šè¿˜è¦ä¾èµ–ä¸€ä¸ª Doris çš„è°ƒè¯•ç¯å¢ƒï¼Œæ‰€ä»¥è¿œç¨‹è°ƒè¯•çš„æ–¹å¼æ˜¯ä¸€ä¸ªå…¨æµç¨‹çš„éªŒè¯ã€‚å¦‚æœç”¨æ”¯æŒgrpc proto file çš„å·¥å…·è°ƒè¯•åªæœ‰ rpc server éƒ¨åˆ†çš„è°ƒè¯•ï¼Œä¸èƒ½å®Œæ•´çš„æµ‹è¯•åŠŸèƒ½ã€‚</p>
</blockquote>
<h4><a class="header" href="#proto-file-è°ƒè¯•" id="proto-file-è°ƒè¯•">proto file è°ƒè¯•</a></h4>
<ul>
<li>Postman ï¼šæœ€æ–°ç‰ˆæœ¬æ”¯æŒ GRPCï¼Œå¯ä»¥é€šè¿‡ç•Œé¢å»è°ƒè¯•æ¯”è¾ƒå‹å¥½</li>
<li>BloomRPC ï¼šå¾ˆé€‚åˆ GRPC çš„ç•Œé¢è°ƒè¯•å·¥å…·</li>
<li>Evans ï¼šä¸€ä¸ª RPC å‘½ä»¤è¡Œè°ƒè¯•å·¥å…·</li>
</ul>
<h4><a class="header" href="#swagger-è°ƒè¯•" id="swagger-è°ƒè¯•">Swagger è°ƒè¯•</a></h4>
<ul>
<li>
<p>ä½¿ç”¨ <a href="https://github.com/grpc-swagger/grpc-swagger">grpc-swagger</a> è¿™ä¸ªé¡¹ç›®:</p>
<pre><code class="language-shell">java -jar grpc-swagger-web/target/grpc-swagger.jar --server.port=8888
</code></pre>
</li>
<li>
<p>åœ¨ RPC Server ä¸­å¼€å¯åå°„æ¨¡å¼ï¼š</p>
<pre><code class="language-java">            server = ServerBuilder.forPort(port)
                    .addService(... some server)
                    .addService(ProtoReflectionService.newInstance()) // åå°„æ¨¡å¼ï¼Œå¯ä»¥æŠŠè¿™å—ä»£ç ç”¨ debug æ§åˆ¶ 
                    .build()
                    .start();
</code></pre>
</li>
<li>
<p>æ‰“å¼€ Swagger</p>
<p><img src="./assets/grpc-swagger.png" alt="" /></p>
</li>
</ul>
<h4><a class="header" href="#idea-è¿œç¨‹è°ƒè¯•" id="idea-è¿œç¨‹è°ƒè¯•">IDEA è¿œç¨‹è°ƒè¯•</a></h4>
<p>è¿œç¨‹æœåŠ¡å™¨ä¸Šå¯åŠ¨æœåŠ¡</p>
<pre><code class="language-shell">java -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=[ip]:5005 -jar jrudf-jar-with-dependencies.jar
# åå°è¿è¡Œ
nohup java -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=[ip]:5005 -jar jrudf-jar-with-dependencies.jar &gt;jrudf.log 2&gt;&amp;1 &amp;
</code></pre>
<p>æœ¬åœ° IDEA æ·»åŠ  Remote é…ç½®:
<code>Edit Configurtions-&gt; Add New Configrution-&gt;Remote JVM Debug</code></p>
<img src="assets/idea-remote-debug.png" alt="idea-remote-debug" style="zoom:50%;" />
<h2><a class="header" href="#remote-udf-æµ‹è¯•" id="remote-udf-æµ‹è¯•">Remote UDF æµ‹è¯•</a></h2>
<blockquote>
<p>ç”±äºå½“å‰ç‰ˆæœ¬ä¸æ”¯æŒ remote UDF ï¼Œæ‰€ä»¥é‡‡ç”¨ä¸»å¹²åˆ†æ”¯çš„ç¼–è¯‘ç‰ˆæœ¬ï¼Œç¼–è¯‘æ–¹å¼å‚è€ƒé™„å½•ä¸­çš„æ–‡æ¡£ã€Šç¼–è¯‘ Dorisã€‹ã€‚</p>
</blockquote>
<h3><a class="header" href="#åŠŸèƒ½æµ‹è¯•" id="åŠŸèƒ½æµ‹è¯•">åŠŸèƒ½æµ‹è¯•</a></h3>
<h4><a class="header" href="#åœ¨-doris-ä¸Šåˆ›å»º-udf" id="åœ¨-doris-ä¸Šåˆ›å»º-udf">åœ¨ Doris ä¸Šåˆ›å»º UDF</a></h4>
<p>ç›®å‰æš‚ä¸æ”¯æŒ UDAF å’Œ UDTF</p>
<pre><code class="language-sql">CREATE FUNCTION
name ([,...])
[RETURNS] rettype
PROPERTIES ([&quot;key&quot;=&quot;value&quot;][,...])
</code></pre>
<p>è¯´æ˜ï¼š</p>
<pre><code class="language-txt">PROPERTIESä¸­symbolè¡¨ç¤ºçš„æ˜¯ rpc è°ƒç”¨ä¼ é€’çš„æ–¹æ³•åï¼Œè¿™ä¸ªå‚æ•°æ˜¯å¿…é¡»è®¾å®šçš„ã€‚
PROPERTIESä¸­object_fileè¡¨ç¤ºçš„ rpc æœåŠ¡åœ°å€ï¼Œç›®å‰æ”¯æŒå•ä¸ªåœ°å€å’Œ brpc å…¼å®¹æ ¼å¼çš„é›†ç¾¤åœ°å€ï¼Œé›†ç¾¤è¿æ¥æ–¹å¼ å‚è€ƒ æ ¼å¼è¯´æ˜ (opens new window)ã€‚
PROPERTIESä¸­typeè¡¨ç¤ºçš„ UDF è°ƒç”¨ç±»å‹ï¼Œé»˜è®¤ä¸º Nativeï¼Œä½¿ç”¨ Rpc UDFæ—¶ä¼  RPCã€‚
name: ä¸€ä¸ªfunctionæ˜¯è¦å½’å±äºæŸä¸ªDBçš„ï¼Œnameçš„å½¢å¼ä¸ºdbName.funcNameã€‚å½“dbNameæ²¡æœ‰æ˜ç¡®æŒ‡å®šçš„æ—¶å€™ï¼Œå°±æ˜¯ä½¿ç”¨å½“å‰sessionæ‰€åœ¨çš„dbä½œä¸ºdbNameã€‚

</code></pre>
<p><em><strong>æ³¨ï¼šç‰¹åˆ«è¯´æ˜ï¼ŒPROPERTIES.symbol å’Œ name å¼ºåˆ¶ä¸€è‡´ï¼Œå‘ç°åœ¨ set enable_vectorized_engine=true è°ƒç”¨ä¼ çš„å‡½æ•°åæ˜¯ nameï¼Œfalse æ—¶ä¼  symbol</strong></em></p>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="language-sql">CREATE FUNCTION rpc_add(INT, INT) RETURNS INT PROPERTIES (
&quot;SYMBOL&quot;=&quot;add_int&quot;,
&quot;OBJECT_FILE&quot;=&quot;127.0.0.1:9000&quot;,
&quot;TYPE&quot;=&quot;RPC&quot;
);
</code></pre>
<h4><a class="header" href="#ä½¿ç”¨-udf" id="ä½¿ç”¨-udf">ä½¿ç”¨ UDF</a></h4>
<p>ç”¨æˆ·ä½¿ç”¨ UDF å¿…é¡»æ‹¥æœ‰å¯¹åº”æ•°æ®åº“çš„ SELECT æƒé™ã€‚</p>
<p>UDF çš„ä½¿ç”¨ä¸æ™®é€šçš„å‡½æ•°æ–¹å¼ä¸€è‡´ï¼Œå”¯ä¸€çš„åŒºåˆ«åœ¨äºï¼Œå†…ç½®å‡½æ•°çš„ä½œç”¨åŸŸæ˜¯å…¨å±€çš„ï¼Œè€Œ UDF çš„ä½œç”¨åŸŸæ˜¯ DBå†…éƒ¨ã€‚å½“é“¾æ¥ session ä½äºæ•°æ®å†…éƒ¨æ—¶ï¼Œç›´æ¥ä½¿ç”¨ UDF åå­—ä¼šåœ¨å½“å‰DBå†…éƒ¨æŸ¥æ‰¾å¯¹åº”çš„ UDFã€‚å¦åˆ™ç”¨æˆ·éœ€è¦æ˜¾ç¤ºçš„æŒ‡å®š UDF çš„æ•°æ®åº“åå­—ï¼Œä¾‹å¦‚ dbName.funcNameã€‚</p>
<h4><a class="header" href="#åˆ é™¤-udf" id="åˆ é™¤-udf">åˆ é™¤ UDF</a></h4>
<p>å½“ä½ ä¸å†éœ€è¦ UDF å‡½æ•°æ—¶ï¼Œä½ å¯ä»¥é€šè¿‡ä¸‹è¿°å‘½ä»¤æ¥åˆ é™¤ä¸€ä¸ª UDF å‡½æ•°, å¯ä»¥å‚è€ƒ DROP FUNCTION</p>
<p><em><strong>æ³¨ï¼šæµ‹è¯•ç»“è®ºä¸€å¹¶åœ¨æ€§èƒ½æµ‹è¯•éƒ¨åˆ†è¯´æ˜</strong></em></p>
<h3><a class="header" href="#æ€§èƒ½æµ‹è¯•" id="æ€§èƒ½æµ‹è¯•">æ€§èƒ½æµ‹è¯•</a></h3>
<h4><a class="header" href="#æµ‹è¯•æ¨¡å‹" id="æµ‹è¯•æ¨¡å‹">æµ‹è¯•æ¨¡å‹</a></h4>
<blockquote>
<h4><a class="header" href="#è¯´æ˜" id="è¯´æ˜">è¯´æ˜</a></h4>
<p>Native UDF åœ¨æ€§èƒ½ä¸Šæœ‰å¤©ç„¶çš„ä¼˜åŠ¿ï¼Œæ‰€ä»¥æ¯”è¾ƒæ€§èƒ½æ—¶ï¼Œéœ€è¦å¼€å¯ Doris çš„å‘é‡åŒ–å¼•æ“æ‰æœ‰æ¯”è¾ƒçš„æ„ä¹‰ï¼Œè¿™é‡Œåªæ˜¯ç®€å•çš„è®¾è®¡å‡ ä¸ªå¯¹ç…§ç»„ï¼Œæ¯ç»„æ‰§è¡Œ10æ¬¡æŸ¥è¯¢ï¼Œåˆ†åˆ«ä¸ºï¼š</p>
<ul>
<li>Build-in Functionï¼ˆ<code>lenght()</code>ï¼‰</li>
<li>Native UDF</li>
<li>Remote UDF 1 ï¼ˆenable_vectorized_engine = falseï¼‰ <em><strong>è¿™ä¸€ç»„æµ‹è¯•æ— æ³•å®Œæˆ</strong></em></li>
<li>Remote UDF 2ï¼ˆenable_vectorized_engine = trueï¼Œbatch_size = 1024ï¼‰</li>
<li>Remote UDF 3ï¼ˆenable_vectorized_engine = trueï¼Œbatch_size = 2048ï¼‰</li>
<li>Remote UDF 4ï¼ˆenable_vectorized_engine = trueï¼Œbatch_size = 4096ï¼‰</li>
<li>Remote UDF 5ï¼ˆenable_vectorized_engine = trueï¼Œbatch_size = 8192ï¼‰</li>
</ul>
<p><em><strong>å‡½æ•°é€»è¾‘ï¼šUDF çš„å®ç°é€»è¾‘ str.length()</strong></em>ï¼Œå†…ç½®å‡½æ•°é€‰å– <code>length()</code> è¿›è¡Œæ¯”è¾ƒ</p>
<p>æµ‹è¯•å·¥å…·ï¼šmysqlslqp</p>
<p>æµ‹è¯•æ•°æ®ï¼šä½¿ç”¨ Doris SSB ä¸­çš„ Customer è¡¨ï¼Œ150 ä¸‡</p>
<p>æµ‹è¯•ç¯å¢ƒï¼š3 be 32G/8Cï¼ŒRPC Server JVM é»˜è®¤</p>
<p>Doris ç‰ˆæœ¬ï¼š
â€‹	branch master
â€‹	latest commit <a href="https://github.com/apache/incubator-doris/commit/f4663ad2eb3fc8ce929304ccdea09d87bb86ec8a"><code>f4663ad</code></a>
â€‹	Compiled from the official docker image</p>
</blockquote>
<h4><a class="header" href="#æµ‹è¯•ç»“æœ" id="æµ‹è¯•ç»“æœ">æµ‹è¯•ç»“æœ</a></h4>
<p>å•èŠ‚ç‚¹çš„ rpc server ä¸‹å¾—å‡ºå¦‚ä¸‹æµ‹è¯•æ•°æ®ï¼š</p>
<pre><code class="language-shell">##########################################################################
å…¨å±€å‚æ•°ï¼š
client_num=10
queries_num=10
æµ‹è¯•ç»“æœï¼š 
test_name        mode   avg    min    max    client_num  queries_per_client
build-in         mixed  1.784  1.669  1.856  10          1
n-udf-f          mixed  1.865  1.791  1.957  10          1
r-udf-2-t-1024   mixed  3.609  3.388  3.787  10          1
r-udf-3-t-2048   mixed  3.032  2.748  3.775  10          1
r-udf-4-t-4096   mixed  2.506  2.347  2.942  10          1
r-udf-5-t-8192   mixed  2.178  2.059  2.374  10          1
r-udf-6-t-16384  mixed  1.971  1.848  2.271  10          1
#########################################################################
</code></pre>
<p>åœ¨ 3 ä¸ªèŠ‚ç‚¹çš„ rpc server ä¸‹å¾—å‡ºå¦‚ä¸‹æµ‹è¯•æ•°æ®ï¼š</p>
<pre><code class="language-shell">##########################################################################
å…¨å±€å‚æ•°ï¼š
client_num=10
queries_num=10
æµ‹è¯•ç»“æœï¼š 
test_name        mode   avg    min    max    client_num  queries_per_client
build-in         mixed  1.683  1.252  1.923  10          1
n-udf-f          mixed  1.797  1.694  1.912  10          1
r-udf-2-t-1024   mixed  2.384  1.882  3.388  10          1
r-udf-3-t-2048   mixed  1.688  1.479  1.886  10          1
r-udf-4-t-4096   mixed  1.455  1.374  1.615  10          1
r-udf-5-t-8192   mixed  1.358  1.272  1.436  10          1
r-udf-6-t-16384  mixed  1.329  1.265  1.474  10          1
#########################################################################
</code></pre>
<h4><a class="header" href="#æµ‹è¯•ç»“è®º" id="æµ‹è¯•ç»“è®º">æµ‹è¯•ç»“è®º</a></h4>
<ol>
<li>Native UDF ä¸å†…ç½®å‡½æ•°çš„<strong>æ€§èƒ½åŸºæœ¬ä¸€è‡´</strong></li>
<li>åœ¨éå‘é‡åŒ–å¼•æ“çš„ç¯å¢ƒä¸‹ï¼ˆenable_vectorized_engine = falseï¼‰ï¼ŒRemote UDF æ€§èƒ½<strong>æå·®</strong></li>
<li>åœ¨å‘é‡åŒ–å¼•æ“çš„ç¯å¢ƒä¸‹ï¼ˆenable_vectorized_engine = trueï¼‰ï¼ŒNative UDF <strong>æ— æ³•ä½¿ç”¨</strong></li>
<li><strong>æ¨è</strong>ä½¿ç”¨é…ç½® enable_vectorized_engine = trueï¼Œbatch_size = 4096 ï¼ˆå®é™…åšäº†å‡ åæ¬¡éªŒè¯ï¼Œè¿™ä¸ªé…ç½®æ˜¯æœ€ç¨³å®šçš„ï¼‰</li>
<li>åœ¨ <strong>4</strong> æ¨èé…ç½®ä¸‹ï¼Œå•èŠ‚ç‚¹ rpc server æ—¶ï¼ŒRemote UDF ä¸ Native UDF <strong>æ€§èƒ½å·®è·å¤§æ¦‚æœ‰ 35%</strong></li>
<li>åœ¨ <strong>4</strong> æ¨èé…ç½®ä¸‹ï¼Œ3 èŠ‚ç‚¹ rpc server æ—¶ï¼ŒRemote UDF ä¸ Native UDF <strong>æ€§èƒ½é¢†å…ˆå¤§æ¦‚æœ‰ 36%</strong>ï¼ˆæ­¤æ—¶ Doris æ²¡æœ‰æ˜æ˜¾ç“¶é¢ˆï¼Œç›®å‰æ²¡æœ‰å‡†ç¡®çš„æ•°æ®å»æè¿°èŠ‚ç‚¹æ•°é‡å¯¹äºRemote UDF æ€§èƒ½çš„çº¿æ€§å½±å“æœ‰å¤šå¤§ï¼Œä¸æ’é™¤åœ¨æ›´é«˜è§„æ ¼ä¸‹ Native UDF å¯èƒ½è¡¨ç°æ›´ä½³ï¼‰
<ul>
<li>è¿™ä¸ªç»“è®ºç¬¦åˆå®˜æ–¹çš„æè¿°<code>åŸºäºå‘é‡åŒ–å’Œæ‰¹å¤„ç†æ–¹å¼çš„ Remote UDF æ€§èƒ½å’ŒåŸºäºè¡Œå­˜çš„ Native UDF æ€§èƒ½ç›¸å½“</code></li>
</ul>
</li>
<li>ä¸æ’é™¤å¤„ç†å¤æ‚çš„è‡ªå®šä¹‰å‡½æ•°æ—¶ Remote UDF æ€§èƒ½è¡¨ç°ä¼šä¸‹é™ï¼Œç‰¹åˆ«æ˜¯æœ‰å¤§é‡æ•°æ®è¦é€šè¿‡ç½‘ç»œä¼ è¾“æ—¶ï¼Œæ¨èé…ç½®ä¹Ÿä¼šéšåœºæ™¯ä¸åŒæœ‰æ‰€ä¸åŒ</li>
</ol>
<h2><a class="header" href="#æ€»ç»“" id="æ€»ç»“">æ€»ç»“</a></h2>
<p><strong>ä»æ•´ä½“æ–¹æ¡ˆä¸Šåšä¸€ä¸‹æ€»ç»“å’Œå¯¹æ¯”ï¼š</strong></p>
<table><thead><tr><th></th><th>Native UDF</th><th>Remote UDF</th></tr></thead><tbody>
<tr><td>ç”¨æˆ·</td><td>ä½¿ç”¨æ–¹å¼ä¸Šä¸å†…ç½®å‡½æ•°ä¸€è‡´çš„ä½“éªŒ</td><td>ä½¿ç”¨æ–¹å¼ä¸Šä¸å†…ç½®å‡½æ•°ä¸€è‡´çš„ä½“éªŒ</td></tr>
<tr><td>ç¤¾åŒº</td><td>å½“å‰ç‰ˆæœ¬æ”¯æŒ</td><td><strong>é¢„è®¡ä¸‹ä¸€ä¸ªç‰ˆæœ¬æ”¯æŒï¼›è¿™ä¸ªå¯¹ç¨³å®šæ€§ã€å®‰å…¨ä¹Ÿæœ‰è¾ƒå¤§çš„å½±å“ï¼Œå½“å‰åŠŸèƒ½éªŒè¯æ˜¯åŸºäºä¸»å¹²ç‰ˆæœ¬ç¼–è¯‘çš„</strong></td></tr>
<tr><td>åŠŸèƒ½</td><td>æ»¡è¶³</td><td>æ»¡è¶³ï¼ˆ<em><strong>å½“å‰ç‰ˆæœ¬ä¸æ”¯æŒ</strong></em>ï¼‰</td></tr>
<tr><td>ç¨³å®šæ€§</td><td>éœ€è¦ä»£ç æ¥ä¿è¯</td><td>éœ€è¦ä»£ç æ¥ä¿è¯ï¼ˆ<em><strong>å½“å‰ç‰ˆæœ¬ä¸æ”¯æŒï¼Œç¼–è¯‘ç‰ˆæœ¬å¯èƒ½ä¼šå¼•å…¥ä¸ç¨³å®šå› ç´ </strong></em>ï¼‰</td></tr>
<tr><td>æ€§èƒ½</td><td>å¤šæ•°æƒ…å†µä¸‹ä¼šå¥½äº Remote UDF</td><td>åœ¨å‘é‡åŒ–å’Œæ‰¹å¤„ç†æ¨¡å¼ä¸‹æ€§èƒ½ä¸ Native ç›¸å½“ï¼›å…·å¤‡ä¸€å®šçš„ä¼¸ç¼©èƒ½åŠ›</td></tr>
<tr><td>å®‰å…¨</td><td>ä¸å¯é çš„ç¨‹åºï¼Œä¼šç›´æ¥å½±å“ Doris</td><td>ç›¸å¯¹æ›´å®‰å…¨ï¼›ç‰¹åˆ«æ˜¯ä½¿ç”¨ VM çš„è¯­è¨€</td></tr>
<tr><td>å¼€å‘å’Œç»´æŠ¤</td><td>ç›¸å¯¹æˆæœ¬<strong>é«˜</strong>ï¼š<br>1ã€C ç³»æŠ€æœ¯æ ˆèƒ½åŠ›å½“å‰å›¢é˜Ÿå‚¨å¤‡ä¸è¶³ï¼Œé•¿æœŸæ¥çœ‹æ— æŠ•å…¥è®¡åˆ’<br>2ã€C ç³»è¯­è¨€çš„ç¨‹åºç¼–å†™ã€debugã€ä¼˜åŒ–ã€review ç­‰å¿ƒæ™ºæˆæœ¬è¾ƒé«˜<br>3ã€åœ¨å¤„ç†å¤æ‚çš„è‡ªå®šä¹‰é€»è¾‘æ—¶ï¼Œ<strong>2</strong> çš„æŒ‘æˆ˜ä¼šæ”¾å¤§ï¼ˆæœ¬èº«ç¼–ç çš„ç»éªŒï¼›ç±»åº“çš„ç¼ºä¹ï¼Œ Java ï¼ŒPython å¯¹æ•°æ®å¤„ç†ç›¸å¯¹å‹å¥½ï¼‰</td><td>ç›¸å¯¹æˆæœ¬<strong>ä½</strong>ï¼š<br/>è·¨è¯­è¨€ï¼Œç±»åº“å¤šï¼›ä¸€æ¬¡æ€§çš„æŠ•å…¥ï¼Œå®šä¹‰å¥½å¼€å‘èŒƒå¼ï¼Œå¯ä»¥é•¿æœŸæ”¶ç›Š</td></tr>
</tbody></table>
<p>åœ¨ä¸è€ƒè™‘å›¢é˜ŸæŠ€èƒ½æƒ…å†µä¸‹ï¼Œé€‰æ‹© Native UDF çš„æ–¹æ¡ˆæ˜¯æ¯”è¾ƒåˆé€‚çš„ï¼ŒåŠŸèƒ½ä¸Šæ»¡è¶³ï¼Œæ€§èƒ½ç›¸å¯¹æ›´ç¨³å®šï¼›Remote UDF ç°é˜¶æ®µç¤¾åŒºçš„ç‰ˆæœ¬ä¸æ”¯æŒï¼Œæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤§çš„é—®é¢˜ï¼Œç¼–è¯‘æ˜¯ä¸€ä¸ªï¼Œä¸»è¦è¿˜æ˜¯é release ç‰ˆæœ¬çš„<strong>ç¨³å®šæ€§</strong>å’Œ<strong>å®‰å…¨</strong>æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤§çš„æŒ‘æˆ˜ã€‚</p>
<p>æ‰€ä»¥æ‰€æœ‰æ–¹æ¡ˆåˆ°æœ€åéƒ½ä¸æ˜¯è®¨è®ºå¥½ä¸å¥½çš„é—®é¢˜ï¼Œè€Œæ˜¯åˆä¸åˆé€‚çš„é—®é¢˜ã€‚</p>
<p>ç»¼åˆè€ƒè™‘åŠŸèƒ½ã€ç¨³å®šæ€§æ˜¯æˆ‘ä»¬è¿«åˆ‡çš„éœ€æ±‚ï¼Œæ€§èƒ½ä¸Šéƒ½æœ‰åŸºæœ¬åŒç­‰çº§åˆ«çš„å®ç°æ–¹å¼ï¼šç°é˜¶æ®µä½¿ç”¨ Native UDF å»æ”¯æŒéœ€æ±‚ï¼›é•¿æœŸæ¥çœ‹ï¼Œå¾…ç¤¾åŒºç‰ˆæœ¬ç¨³å®šæ”¯æŒ Remote UDF æ—¶ï¼Œå®šä¹‰å¥½å¼€å‘èŒƒå¼ï¼Œç”¨å½“å‰å›¢é˜Ÿç†Ÿæ‚‰çš„æŠ€æœ¯æ ˆæ¥å¼€å‘ UDF RPC Server æ¥è¿ç§»å½“å‰çš„éœ€æ±‚ã€‚</p>
<h1><a class="header" href="#é™„å½•" id="é™„å½•">é™„å½•</a></h1>
<h2><a class="header" href="#ç¼–è¯‘-doris" id="ç¼–è¯‘-doris">ç¼–è¯‘ Doris</a></h2>
<p><em><strong>ç”±äºå½“å‰ç‰ˆæœ¬ï¼ˆ0.15ï¼‰ä¸æ”¯æŒ Remote UDFï¼Œæ‰€ä»¥ç¼–è¯‘ Doris æœ€æ–°ç‰ˆæœ¬è¿›è¡ŒåŠŸèƒ½éªŒè¯</strong></em></p>
<h3><a class="header" href="#å®‰è£…-docker-ç¯å¢ƒ-ç•¥" id="å®‰è£…-docker-ç¯å¢ƒ-ç•¥">å®‰è£… Docker ç¯å¢ƒ ï¼ˆç•¥ï¼‰</a></h3>
<p><em><strong>æ¨èä½¿ç”¨ Docker é›†æˆçš„ç¼–è¯‘ç¯å¢ƒå»è¿›è¡Œ Doris ç¼–è¯‘</strong></em></p>
<h3><a class="header" href="#ä¸‹è½½ç¼–è¯‘é›†æˆç¯å¢ƒé•œåƒ" id="ä¸‹è½½ç¼–è¯‘é›†æˆç¯å¢ƒé•œåƒ">ä¸‹è½½ç¼–è¯‘é›†æˆç¯å¢ƒé•œåƒ</a></h3>
<pre><code class="language-shell">docker pull apache/incubator-doris:build-env-ldb-toolchain-latest
</code></pre>
<h3><a class="header" href="#ä¸‹è½½-doris-æºç " id="ä¸‹è½½-doris-æºç ">ä¸‹è½½ Doris æºç </a></h3>
<pre><code class="language-shell">mkdir -p /opt/doris &amp;&amp; cd /opt/doris
git clone https://github.com/apache/incubator-doris.git
</code></pre>
<h3><a class="header" href="#è¿è¡Œç¼–è¯‘é›†æˆç¯å¢ƒ" id="è¿è¡Œç¼–è¯‘é›†æˆç¯å¢ƒ">è¿è¡Œç¼–è¯‘é›†æˆç¯å¢ƒ</a></h3>
<pre><code class="language-shell">docker run -it -v /root/.m2:/root/.m2 -v /opt/doris/incubator-doris/:/root/incubator-doris/ apache/incubator-doris:build-env-ldb-toolchain-latest
</code></pre>
<h3><a class="header" href="#ç¼–è¯‘" id="ç¼–è¯‘">ç¼–è¯‘</a></h3>
<pre><code class="language-shell">cd /root/incubator-doris/
sh build.sh --clean --be --fe --ui
</code></pre>
<h3><a class="header" href="#æ‰“åŒ…æ„å»º" id="æ‰“åŒ…æ„å»º">æ‰“åŒ…æ„å»º</a></h3>
<pre><code class="language-shell">tar zcvf apache-doris-latest-454b45b-incubating.tar.gz ./output
</code></pre>
<p><em><strong>454b45b æ˜¯æºç çš„ commit hash id</strong></em></p>
<h2><a class="header" href="#é—®é¢˜" id="é—®é¢˜">é—®é¢˜</a></h2>
<ul>
<li>proto ç¼–è¯‘è¦ä¿®æ”¹å®˜æ–¹çš„ pomæ–‡ä»¶ä¸­ <code>protoc</code> ç¯å¢ƒçš„ä½ç½®</li>
</ul>
<pre><code class="language-xml">&lt;protocCommand&gt;${doris.thirdparty}/installed/bin/protoc&lt;/protocComm&gt; &lt;!-- ä¿®æ”¹æˆ protoc çš„å®‰è£…ä½ç½® --&gt;
</code></pre>
<ul>
<li>
<p>Doris æºç ç¼–è¯‘æ—¶ gcc  æ‰¾ä¸åˆ°ï¼Œç‰ˆæœ¬ä¸å¯¹</p>
<p>éœ€è¦ which ä¸€ä¸‹çœ‹çœ‹ gcc çš„ä½ç½®ï¼Œåœ¨ <code>env.sh</code> ä¸­è®¾ç½®ä¸€ä¸‹ <code>${DORIS_GCC_HOME}</code></p>
</li>
</ul>
<h2><a class="header" href="#ref" id="ref">ref</a></h2>
<ul>
<li><a href="https://doris.apache.org/zh-CN/extending-doris/udf/remote-user-defined-function.html">Doris Remote UDF</a></li>
<li><a href="https://doris.apache.org/zh-CN/installing/compilation.html#%E4%BD%BF%E7%94%A8-docker-%E5%BC%80%E5%8F%91%E9%95%9C%E5%83%8F%E7%BC%96%E8%AF%91-%E6%8E%A8%E8%8D%90">Doris ç¼–è¯‘</a></li>
<li><a href="https://dev.mysql.com/doc/refman/8.0/en/mysqlslap.html">mysqlslap</a></li>
</ul>

                        <div id="giscus-container"></div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../../../tech/bestpractices/sqlæ€§èƒ½æµ‹è¯•å·¥å…·çš„è®¾è®¡.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../../../tech/bestpractices/ç¦…é“å·¥ä½œæµ.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../../../tech/bestpractices/sqlæ€§èƒ½æµ‹è¯•å·¥å…·çš„è®¾è®¡.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../../../tech/bestpractices/ç¦…é“å·¥ä½œæµ.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../book.js" type="text/javascript" charset="utf-8"></script>
        <script type="text/javascript" charset="utf-8">
        var pagePath = "tech/bestpractices/jrudf/doris-remote-udf.md"
        </script>


        <!-- Custom JS scripts -->
        
        <script type="text/javascript" src="../../../assets/custom.js"></script>
        
        <script type="text/javascript" src="../../../assets/showBigPicture.js"></script>
        

        

    </body>
</html>